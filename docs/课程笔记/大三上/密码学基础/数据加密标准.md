## 分组密码

分组密码分为对称分组密码与非对称分组密码，习惯上多指的是对称分组密码

分组密码主要任务是提供数据保密性，也可以用于构造**伪随机数生成器**、**哈希函数**、**序列密码**等

特点：分组密码加解密速度较快，安全性好，得到了许多密码芯片的支持

### 分组密码要求

- 分组长度足够大
    - 分组长度小，攻击者可以通过穷举法进行暴力破解
- 密钥量足够大
- 密码变换足够复杂
- 加密和解密运算简单
- 无数据扩展或压缩

> 分组密码的设计思想中有扩散与混淆两个重要概念，即雪崩效应和关系复杂化

### 分组密码要求——关于置换

对于一个分组长度为n的分组密码，不同密钥对应不同的加密解密变换，对于给定的密钥k，加密变换$E_k$是$GF(2)^n$上的一个变换

为了方便密钥管理，通常密钥长度t不能太大

## 乘积密码

原理：依次使用两个或两个以上的基本密码，所得密码强度强于单个密码的强度

实现方法：通常使用混淆、扩散两种基本密码操作组合变换实现

效果：利用少量软硬件资源实现混淆、扩散

### 乘积密码——SPN

SPN是乘积密码的一种由多重S变换和P变换组合成的变换网络，其基本操作是S变换（代换）与P变换（置换），前者称为“S盒”，后者称为“P盒”。

S盒起到混淆作用，P盒起到扩散作用

## 分组密码结构——子密钥生成

- 子密钥生成算法定位
    - 从初始密钥产生各轮迭代使用的子密钥，轮函数F的功能是在子密钥的参与和控制下实现

> 轮函数基本准则：非线性、体现安全性；保证基本的加解密实现；高性能；
>
> 分组密码一般采用简单、安全性弱的密码函数进行多轮迭代

## DES

### DES由来

1973年，美国国家标准局在美国征集国家加密标准，经过海选、初选、决赛，最后IBM公司的Lucifer加密系统获得了胜利，1977年1月15日NBS决定利用这个算法，并更名为Data Encryption Standard，简称DES

### 基本参数

- 分组加密算法：明文和密文为64位分组长度
- 密码算法：加密和解密除了子密钥编排不同之外，使用同一算法
- 密钥长度：56位，但存在弱密钥
- 采用混淆和扩散的组合：每个组合先代换后置换，共16轮
- 只使用了简单的逻辑运算

### 加密流程

$$\begin{cases}
    L_0R_0\leftarrow IP(<64bit明文>)\\
    L_i\leftarrow R_{i-1} & i=1,2,\dots ,16\\
    R_i\leftarrow L_{i-1}\oplus F(R_{i-1},k_i) & i=1,2,\dots ,16\\
    <64bit密文>\leftarrow IP^{-1}(R_{16}L_{16})
\end{cases}$$

### 轮函数F实现流程

对于$R_{i-1}\rightarrow R_i$：选择**扩展运算E**，将32bit扩展为48bit与子密钥$K_i$进行异或运算，再使用**压缩运算S**将48bit压缩至32bit，使用**置换运算P**后，再与$L_{i-1}$异或得到$R_i$

对于$L_{i}$，直接使用$R_{i-1}$作为$L_{i}$

### 选择扩展置换E

8个4位分组，将每个分组扩展为6位，32个输入位正好有16个输入位在输出中出现了两次。但是任意一个输入位都不会在同一个6位的输出分组出现两次。

扩展盒（E-盒）增加了DES的扩散行为，因为某些输入位会影响两个不同的输出位置。

<figure markdown>
![img](https://github.com/DINOREXNB/dinorexnb.github.io/blob/main/docs/images/enc3-1.png?raw=true){width=500}
<figcaption></figcaption>
</figure>

### 压缩运算S