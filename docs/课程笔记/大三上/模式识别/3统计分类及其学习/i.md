## 概率论与统计学习

- 判别式模型：
    - 将x看做特征空间中的点
    - 构建判别函数g(x)来决定x属于哪个类别
    - 关键在于计算x与训练样本$x_i$的内积关系
- 产生式模型
    - 将x看做随机变量
    - 根据x属于各类别$\omega_i$的概率分布p(x|\omega_i)来决定其类别
    - 关键在于计算不同类别产生“待识别模式”的概率$P(x|\omega_i)$

### 推理

![alt text](image.png){width=500px}

解决这种逆概率推理问题的理论就是贝叶斯理论

### 贝叶斯公式

条件概率公式为：$P(B|A)=\frac{P(AB)}{P(A)}$

$$P(B|A)=\frac{P(A|B)P(B)}{P(A)}$$

> 链式法则：$P(a,b,c)=P(a|(b, c))P(b,c)=P(a|(b,c))*P(b|c)*P(c)$

贝叶斯公式的数学表述为：设试验E的样本空间为$\Omega$，A为E的事件，$B_1,B_2,\cdots,B_C$为$\Omega$的一个划分，且$P(A)>0$，$P(B_i)>0$，那么

$$P(B_i|A)=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^C P(A|B_j)P(B_j)}=\frac{P(A|B_i)P(B_i)}{P(A)}$$

### 贝叶斯分类器原理

统计分类是依据样本在各个维度上的特征值分布来进行分类决策的模式识别算法，如果把样本真实所属的类别作为条件，样本的特征值作为结果，则有

- 样本真实类别——条件B
- 样本特征值——结果A
- 分类决策——逆推理，最终根据概率的大小来做出分类决策

对于不确定的统计分类，我们已知每个类别的样本取得不同特征向量的概率，现在需要依据某个待识样本的特征向量，计算出该样本属于每一个类的概率

- 先验概率$P(\omega_i)$：
- 类条件概率$P(P(x|\omega_i))$
- 后验概率$P(\omega_i|x)$

则可以得到后验概率为$\frac{P(x|\omega_i)P(\omega_i)}{P(x)}$

### 贝叶斯分类示例

假设目前要确定该照片中的人的性别

![alt text](image-1.png){width=300px}

我们可以将“长发”作为一个样本所具有的特征值，我们需要计算的是后验概率$P(男|长发)$和$P(女|长发)$

已知先验概率$P(男)=0.5,P(女)=0.5$

类条件概率：

- $P(长发|男)=0.05$
- $P(长发|女)=0.7$
- 假设$P(男)=0.5,P(女)=0.5$

那么我们得到后验概率$P(男|长发)=\frac{0.05*0.5}{0.05*0.5+0.7*0.5}=0.067$，$P(女|长发)=\frac{0.7*0.5}{0.05*0.5+0.7*0.5}=0.933$

> 无论选择哪一类都有可能犯错，在各类别先验概率不相等时，后验概率也会发生较大变化

### 贝叶斯分类器的特点

1. 先验概率**必须已知**
2. 以新获得的信息对先验概率进行修正
3. 分类决策**存在错误率**

## 贝叶斯决策理论

### 基于最小错误率的贝叶斯决策

#### 两类问题的错误率

观察特征x做出判别的错误率

$$P(error|x)=\begin{cases}
    P(\omega_1|x)&判定\omega_2\\
    P(\omega_2|x)&判定\omega_1
\end{cases}$$

选择其中错误率最小的作为决策

#### 多类问题的最小错误率

判断x属于$\omega_i$的错误率

$$P(error|x)=\sum_{j\neq i}^C P(\omega_j|x)=1-P(\omega_i|x)$$

判断准则为$i=\argmin_{1\leq j\leq c}P(\omega_j|x)$

#### 贝叶斯最小错误率准则

$$g_j(x)=p(x|\omega_j)P(\omega_j)$$

有$i=\argmin_{1\leq j\leq c}g_j(x)$，则$x\in \omega_i$

### 基于最小风险的贝叶斯决策

判断某人是正常(ω正)还是患者(ω患),将出现以下情况

![alt text](image-2.png)

确定决策风险最小：

做出正常判决的风险：$R_正(x)=\lambda_{正\to 正}P(\omega_正|x)+\lambda_{患\to 正}P(\omega_患|x)$

做出患病判决的风险：$R_患(x)=\lambda_{正\to 患}P(\omega_正|x)+\lambda_{患\to 患}P(\omega_患|x)$

> 计算各类决策风险后，选择风险最小的作为决策

### Neyman-Pearson决策规则

限定一类错误率，最小化另一类错误率

## 高斯分布的贝叶斯分类器