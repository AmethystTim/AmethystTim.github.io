## 过程调用的步骤

- 调用者caller vs. 被调用者callee
- Caller将参数放在过程可以访问的寄存器x10~x17/a0~a7
- Caller将控制权交给过程(Callee)
- (Callee)获取过程所需的存储资源
- (Callee)执行过程中的操作
- (Callee)将结果值放在调用程序可以访问到的寄存器s0~s11
- (Callee)返回调用位置(x1/ra中的地址)，控制权交还调用者

## 过程调用指令

- 过程调用
    - `jal x1, ProcedureAddress`
        - 讲下一条指令的地址保存在x1/ra中
        - 跳转到目标地址ProcedureAddress
- 过程返回
    - `jalr x0, 0(x1)`
        - 类似`jal`，但是跳转到0+x1中保存的地址
        - 把x0用作目的寄存器（实际x0不会被改变）
        - 同样可用于跳转到计算出的位置

## 过程调用相关的寄存器

- 返回地址寄存器 x1(ra)
- 参数寄存器 x10-x17(a0-a7)
- 返回值寄存器 x10-x11(a0-a1)
- 保存寄存器 x8,x9,x18-x27(s0,s1,s2-s11)
- 临时寄存器 x5-x7,x28-x31(t0-t2,t3-t6)
- 栈指针 x2(sp)

## RISC-V过程调用（人为设置返回地址）

```
1000|mv a0, s0
1004|mv a1, s1
1008|addi ra, zero, 1016 # ra=1016
1012|j sum # jump to sum
1016|...  # 跳转返回下条指令
... |
2000|sum: add a0, a0, a1
2004|jr ra  # jalr x0, ra, 0
```
> 伪指令j跳转到给定的地址